<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Lab 4 Fast Robot - Shihming Lin</title>
        <link href="css/styles.css" rel="stylesheet" />
        <link rel="icon" type="image/x-icon" href="assets/img/project-cover/right_corner_icon.png" />
        <script data-search-pseudo-elements defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.29.0/feather.min.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div id="layoutDefault">
            <div id="layoutDefault_content">
                <main>
                    <!-- Navbar-->
                    <nav class="navbar navbar-marketing navbar-expand-lg bg-white navbar-light">
                        <div class="container px-5">
                            <a class="navbar-brand text-primary" href="index.html"><img class="img-fluid rounded-3" src="assets/img/project-cover/right_corner_icon.png" /></a>
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><i data-feather="menu"></i></button>
                            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                                <ul class="navbar-nav ms-auto me-lg-5">
                                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                                    <li class="nav-item dropdown dropdown-xl no-caret">
                                        <a class="nav-link dropdown-toggle" id="navbarDropdownDemos" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Projects
                                            <i class="fas fa-chevron-right dropdown-arrow"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-end animated--fade-in-up me-lg-n25 me-xl-n15" aria-labelledby="navbarDropdownDemos">
                                            <div class="row g-0">
                                                <div class="col-lg-5 p-lg-3 bg-img-cover overlay overlay-primary overlay-70 d-none d-lg-block" style="background-image: url('assets/img/backgrounds/bg-dropdown-xl.jpg')">
                                                    <div class="d-flex h-100 w-100 align-items-center justify-content-center">
                                                        <div class="text-white text-center z-1">
                                                            <div class="mb-3">Will add a image of robots/embedded systems or other related projects</div>
                                                            <a class="btn btn-white btn-sm text-primary fw-500" href="index.html">Show details</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-7 p-lg-5">
                                                    <div class="row">
                                                        <div class="col-lg-6">
                                                            <h6 class="dropdown-header text-primary">Web Applications</h6>
                                                            <a class="dropdown-item" href="http://course-enrollment-lsm.s3-website-us-west-2.amazonaws.com/">Course Registration Service</a>
                                                            <a class="dropdown-item" href="https://serene-refuge-47001.herokuapp.com/">Emaily: A Feedback-Collection App</a>
                                                            <a class="dropdown-item" href="#!">E-commerce</a>
                                                            <div class="dropdown-divider border-0"></div>
                                                            <h6 class="dropdown-header text-primary">Robots</h6>
                                                            <a class="dropdown-item" href="fast-robot-all-project-main-page.html">Fast Robot</a>
                                                            <a class="dropdown-item" href="#!">Design and Control of an Autonomous, <br> 4-Legged Construction Robot</a>
                                                            <a class="dropdown-item" href="https://drive.google.com/file/u/3/d/1nS1tiqPLQ61-NSE5_IbpiMUPlx14oYKk/view?usp=sharing">Low-cost Perception System <br> and Remote Management of <br> an Autonomous Wheelchair</a>
                                                            <a class="dropdown-item" href="https://github.com/LexLin004/RelaxU">RelaxU: A Portable And Wearable Massager Tape <br> For Pain Relief and Muscle Recovery</a>
                                                            <div class="dropdown-divider border-0"></div>
                                                            <h6 class="dropdown-header text-primary">FPGA</h6>
                                                            <a class="dropdown-item" href="https://vanhunteradams.com/DE1/Lorenz/Lorenz.html">Hardware ODE solver with HPS control</a>
                                                            <a class="dropdown-item" href="https://vanhunteradams.com/DE1/Mandelbrot/Mandelbrot.html">Mandelbrot Set Visualizer</a>
                                                            <a class="dropdown-item" href="https://vanhunteradams.com/DE1/Drum/Drum_synthesis.html">Multiprocessor Drum Synthesis</a>
                                                            <div class="dropdown-divider border-0 d-lg-none"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="nav-item dropdown dropdown-xl no-caret">
                                        <a class="nav-link dropdown-toggle" id="navbarDropdownPages" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Personal
                                            <i class="fas fa-chevron-right dropdown-arrow"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-end me-lg-n20 me-xl-n15 animated--fade-in-up" aria-labelledby="navbarDropdownPages">
                                            <div class="row g-0">
                                                <div class="col-lg-4 p-lg-5">
                                                    <h6 class="dropdown-header text-primary">Education</h6>
                                                    <a class="dropdown-item" href="#!">One</a>
                                                    <a class="dropdown-item" href="#!">Two</a>
                                                    <div class="dropdown-divider border-0"></div>
                                                    <h6 class="dropdown-header text-primary">Engineering Experience</h6>
                                                    <a class="dropdown-item" href="#!">One</a>
                                                    <a class="dropdown-item" href="#!">Two</a>
                                                    <a class="dropdown-item" href="#!">Three</a>
                                                    <div class="dropdown-divider border-0 d-lg-none"></div>
                                                </div>
                                                <div class="col-lg-4 p-lg-5">
                                                    <h6 class="dropdown-header text-primary">Blogs</h6>
                                                    <a class="dropdown-item" href="page-blog-overview.html">Overview</a>
                                                    <a class="dropdown-item" href="page-blog-post.html">Post</a>
                                                    <a class="dropdown-item" href="page-blog-archive.html">Archive</a>
                                                    <div class="dropdown-divider border-0 d-lg-none"></div>
                                                </div>
                                                <div class="col-lg-4 p-lg-5">
                                                    <h6 class="dropdown-header text-primary">Other Design</h6>
                                                    <a class="dropdown-item" href="#!">1</a>
                                                    <a class="dropdown-item" href="#!">2</a>
                                                    <a class="dropdown-item" href="#!">3</a>
                                                    <a class="dropdown-item" href="#!">4</a>
                                                    <a class="dropdown-item" href="#!">5</a>
                                                    <div class="dropdown-divider border-0 d-lg-none"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    <li class="nav-item dropdown no-caret">
                                        <a class="nav-link dropdown-toggle" id="navbarDropdownDocs" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Documentation
                                            <i class="fas fa-chevron-right dropdown-arrow"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-end animated--fade-in-up" aria-labelledby="navbarDropdownDocs">
                                            <a class="dropdown-item py-3" href="https://docs.startbootstrap.com/sb-ui-kit-pro/quickstart" target="_blank">
                                                <div class="icon-stack bg-primary-soft text-primary me-4"><i data-feather="book-open"></i></div>
                                                <div>
                                                    <div class="small text-gray-500">Documentation</div>
                                                    Usage instructions and reference
                                                </div>
                                            </a>
                                            <div class="dropdown-divider m-0"></div>
                                            <a class="dropdown-item py-3" href="https://docs.startbootstrap.com/sb-ui-kit-pro/components" target="_blank">
                                                <div class="icon-stack bg-primary-soft text-primary me-4"><i data-feather="code"></i></div>
                                                <div>
                                                    <div class="small text-gray-500">Components</div>
                                                    Code snippets and reference
                                                </div>
                                            </a>
                                            <div class="dropdown-divider m-0"></div>
                                            <a class="dropdown-item py-3" href="https://docs.startbootstrap.com/sb-ui-kit-pro/changelog" target="_blank">
                                                <div class="icon-stack bg-primary-soft text-primary me-4"><i data-feather="file-text"></i></div>
                                                <div>
                                                    <div class="small text-gray-500">Changelog</div>
                                                    Updates and changes
                                                </div>
                                            </a>
                                        </div>
                                    </li>
                                </ul>
                                <a class="btn fw-500 ms-lg-4 btn-primary" href="fast-robot-all-project-main-page.html">
                                    Back
                                    <i class="ms-2" data-feather="arrow-right"></i>
                                </a>
                            </div>
                        </div>
                    </nav>
                    <section class="bg-light py-10">
                        <div class="container px-5">
                            <div class="row gx-5 justify-content-center">
                                <div class="col-lg-10 col-xl-8">
                                    <div class="single-post">
                                        <h1>Lab 4 report</h1>
                                        <p class="lead">In this <a href="https://fastrobotscornell.github.io/FastRobots/labs/Lab5.html">lab </a>,
                                            I integrated two <a href="https://www.pololu.com/product-info-merged/2130">DRV8833 Dual Motor Driver </a>
                                             <a href="https://www.ti.com/lit/ds/symlink/drv8833.pdf">(DRV8833 datasheet) </a>  to
                                            my Artemis board to control two motors of the Force1 RC Car. This completes the assembly of the hardware 
                                            part of my robot.</p>
                                        <div class="d-flex align-items-center justify-content-between mb-5">
                                            <div class="single-post-meta me-4">
                                                <img class="single-post-meta-img" src="assets/img/project-cover/right_corner_icon.png" />
                                                <div class="single-post-meta-details">
                                                    <div class="single-post-meta-details-name">Shihming Lin</div>
                                                    <div class="single-post-meta-details-date">Feb 24, 2024</div>
                                                </div>
                                            </div>
                                            <div class="single-post-meta-links">
                                                <a href="https://www.linkedin.com/in/shihming-lin-597008199"><i class="fab fa-linkedin fa-fw"></i></a>
                                                <a href="https://github.com/LexLin004"><i class="fab fa-github fa-fw"></i></a>
                                                <a href="https://github.com/robotconstruction"><i class="fab fa-github fa-fw"></i></a>
                                            </div>
                                        </div>
                                        <div class="single-post-text my-5">
                                            <h2>Prelab</h2>
                                            <h5>Setup for Motor Drivers</h5>
                                            <p> 
                                                According to the <a href="https://cdn.sparkfun.com/assets/5/5/1/6/3/RedBoard-Artemis-Nano.pdf">schematic</a>, 
                                                <a href="https://cdn.sparkfun.com/assets/8/7/5/3/f/Artemis_Integration_Guide.pdf">integration guide</a>,
                                                and currently available pins, I chose to use PIN 2,5,14,15 as output pin to output PWM signals to two 
                                                driver boards. The intended connection is shown in Figure 1. The full connection(include IMU, ToF, switches) 
                                                is shown in Figure 2.
                                            </p>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/connection_scheme.png" />
                                            <div class="small text-gray-500">Figure 1: Connection scheme</div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/fully_connection_scheme.png" />
                                            <div class="small text-gray-500">Figure 2: Fullly Connection scheme</div>
                                            <h5>Battery Discussion</h5>
                                            <p>
                                                In my design, I separated the motor and microcontroller power supplies to isolate the sensitive electronics 
                                                from the electrical noise generated by the motor and to prevent erratic behavior. Moreover, it meets the 
                                                different voltage requirements of the motor and Artemis, and prevents voltage drops from high motor current 
                                                draw from affecting the microcontroller. It also protects the microcontroller from potential damage 
                                                caused by motor or driver failure.
                                            </p>
                                            <h2>Lab tasks</h2>
                                            

                                            <p> I soldered the motor drivers, motors, batterym, and Artemis shown in figure 3 following the connection scheme 
                                                shown in figure 1. Then I built the interior structure of the robot shown in figure 4 and 5 using the two brackets 
                                                shown in figure 6 and 7. The final appearance is shown in Figure 8. Since I realized after installing the 
                                                internal structure that I forgot to take a picture of how the driver board is connected to the artemis, 
                                                please refer to Figure 1 for the specific connection.
                                            </p>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/driver_frontback.jpg" />
                                            <div class="small text-gray-500">Figure 3: Front and back side of soldered driver board</div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/car_internal_up.jpg" />
                                            <div class="small text-gray-500">Figure 4: Robot internal structure upside</div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/car_internal_down.jpg" />
                                            <div class="small text-gray-500">Figure 5: Robot internal structure downside</div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/all_fit_fast_robot_internal_engr_diag_thicker_v5_thicker.png" />
                                            <div class="small text-gray-500">Figure 6: Brackets Design for Artemis Nano, Connector, Motor Drivers</div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/brackets_imu_switches_battery_box_v1.png" />
                                            <div class="small text-gray-500">Figure 7: Bracket Design for IMU, Switches, and Battery box </div>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/car_external_all.jpg" />
                                            <div class="small text-gray-500">Figure 8: Final Appearance </div>
                                            
                                            <p>To test the connection to Artemis' dual motor drivers, I used a 850mah battery as the driver's input and an oscilloscope to read the driver's inputs and outputs:</p>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/pwr_oscilloscope_connect.png" />
                                            <div class="small text-gray-500">Figure 7: Power supply and oscilloscope connection settings</div>
                                            
                                            <p>I added following command to the ble_arduino.ino used in previous lab, thus I can controll the motors via BLE and computer.
                                                The python script used is also shown below. </p>

                                            <script src="https://gist.github.com/LexLin004/da6a93bcef6372d5677188e76f9417da.js"></script>
                                            <script src="https://gist.github.com/LexLin004/20ddaf051f298d83e79c70bc0b0e7ae4.js"></script>

                                            <p> As shown in the video, the left motor can rotate as expected by sending command via BLE from computer to artemis.
                                                First, it rotated forward, then backward. </p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/Hz0Wrq03bQM?si=_0s-hJgZCFBJovTG"> </iframe>

                                            <p> Four wheels (two motors) also rotated as expected. First the right motor spins forward, then the left motor spins forward, 
                                                followed by both motors spinning forward then backward together, and finally stopping.</p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/6SwIC-ziYcU?si=jHi5JCwNa_K92w2G"> </iframe>
                                            
                                            <h5>Lower limit PWM value discussion</h5>
                                            <p>
                                                To test the lower limit PWM value of the robot starting moving on the ground, and since my analogwrite resolution is 16bits, 
                                                I can set pwm from 0 to 65525,  I increased the PWM value from 0 to 15000 until the wheels were able to start moving from 
                                                a stationary position. The lower limit values for motors are around 8000, as shown in the video.
                                            </p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/AYqu3xILjyI?si=HSGekAQKD5SMZVJH"> </iframe>
                                            
                                            <p> I used the same method to test the lower limit PWM value of the robot starting turning on-axis, I increased the PWM value 
                                                from 37000 to 50000. The lower limit values for motors are around 39300, as shown in the video. </p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/TjE_6xqasHY?si=L3zslnkCzYHZ2FJP"> </iframe>
                                           
                                            <h5>Calibration demonstration</h5>
                                            <p>
                                                Since the two motors have different output torques, they need to be calibrated so that the robot can move in a straight line. 
                                                The video below demonstrates applying the same pwm wave to both motors. As shown in the video, the robot veers left a little bit.</p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/shorts/YUuyr-xoZJs"> </iframe>

                                            <p>
                                                This represents the output torques of right motor is larger. Therefore, I need to add a correction factor for the left motor.
                                                After testing, the coefficient is 1.06, since when I used 21200 for pwm of left motor, and 20000 for pwm of right motor, the
                                                car can move in a straight line, as shwon in the following video.
                                            </p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/JN2oPeK0R38"> </iframe>
                                            
                                            <h5>Open loop</h5>
                                            <p>
                                                To demonstrate open-loop control of the robot, I transmitted the following commands to the robot and recorded the video.
                                                The robot does what the code expects, it goes forward, then back, then right, then left, then rotates clockwise, 
                                                then rotates counter-clockwise, and finally stop.
                                            </p>
                                            <iframe width="560" height="315" src="https://www.youtube.com/embed/7bN6Vhq3B4U"> </iframe>

                                            <h5>analogWrite frequency discussion</h5>
                                            <p>
                                                The default PWM frequency for generated by analogWrite() on most Arduino models is around 490 Hz. According to the figure 10, 
                                                the frequency on Artemis board is around 414Hz. This frequency is sufficient for a reasonable balance between efficient 
                                                motor operation and minimal audible noise. I can manually configure the CTIMER and total counts in a PWM period to 
                                                generate a faster PWM signal which lead to smoother motor operation and can be used in applications that require precise 
                                                motion to provide finer motor speed and torque control.
                                            </p>
                                            <img width=500 class="img-fluid mb-2 rounded" src="assets/img/lab_assets/lab4_assets/pwm_frequency_test.jpg" />
                                            <div class="small text-gray-500">Figure 10: PWM frequency test</div>

                                            <h5>Lowest PWM value speed discussion</h5>
                                            <p>
                                                To find the lowest PWM value that would keep the motor moving, I first made the car moving from rest, and then sent the lower 
                                                value to Artemis over BLE to find the value that would stop the motor. According to the test, the lowest PWM value is xxx for 
                                                the right motor and xxx for the left motor, as shown in the following video.
                                            </p>
                                            <iframe width="450" height="450" src=> </iframe>

                                            <hr class="my-5" />
                                            <div class="text-center"><a class="btn btn-transparent-dark" href="fast-robot-all-project-main-page.html">Back to All Reports of Fast Robots Labs</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="svg-border-rounded text-dark">
                            <!-- Rounded SVG Border-->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144.54 17.34" preserveAspectRatio="none" fill="currentColor"><path d="M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"></path></svg>
                        </div>
                    </section>
                </main>
            </div>
<div id="layoutDefault_footer">
                <footer class="footer pt-10 pb-5 mt-auto bg-dark footer-dark">
                    <div class="container px-5">
                        <div class="row gx-5">
                            <div class="col-lg-3">
                                <div class="footer-brand">Shihming Lin</div>
                                <div class="mb-3">Portfolio</div>
                                <div class="icon-list-social mb-5">
                                    <a class="icon-list-social-link" href="#!"><i class="fab fa-instagram"></i></a>
                                    <a class="icon-list-social-link" href="#!"><i class="fab fa-facebook"></i></a>
                                    <a class="icon-list-social-link" href="#!"><i class="fab fa-github"></i></a>
                                    <a class="icon-list-social-link" href="#!"><i class="fab fa-twitter"></i></a>
                                </div>
                            </div>
                            <div class="col-lg-9">
                                <div class="row gx-5">
                                    <div class="col-lg-3 col-md-6 mb-5 mb-lg-0">
                                        <div class="text-uppercase-expanded text-xs mb-4">All Info</div>
                                        <ul class="list-unstyled mb-0">
                                            <li class="mb-2"><a href="#!">Projects</a></li>
                                            <li class="mb-2"><a href="#!">Personal</a></li>
                                            <li class="mb-2"><a href="#!">Documentation</a></li>
                                        </ul>
                                    </div>
                                    <div class="col-lg-3 col-md-6">
                                        <div class="text-uppercase-expanded text-xs mb-4">Legal</div>
                                        <ul class="list-unstyled mb-0">
                                            <li class="mb-2"><a href="#!">Privacy Policy</a></li>
                                            <li class="mb-2"><a href="#!">Terms and Conditions</a></li>
                                            <li><a href="#!">License</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="my-5" />
                        <div class="row gx-5 align-items-center">
                            <div class="col-md-6 small">Copyright &copy; LexLin004.github.io 2024</div>
                            <div class="col-md-6 text-md-end small">
                                <a href="#!">Privacy Policy</a>
                                &middot;
                                <a href="#!">Terms &amp; Conditions</a>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
    </body>
</html>
